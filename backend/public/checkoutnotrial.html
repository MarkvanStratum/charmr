<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Charmr • Checkout</title>

  <!-- Stripe.js -->
  <script src="https://js.stripe.com/v3"></script>

  <!-- Charmr-like styling -->
  <style>
    :root{
      --pink:#ff4d6d;
      --pink-2:#e63b5e;
      --cta:#ef476f;
      --bg1:#ffcccc;
      --bg2:#ffe6e6;
      --ink:#222;
      --muted:#666;
      --card:#fff;
      --ring:#ffd1dc;
      --shadow:0 8px 24px rgba(0,0,0,.12);
      --radius:16px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: Arial, Helvetica, sans-serif;
      background: linear-gradient(var(--bg1), var(--bg2));
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      color:var(--ink);
    }
    .shell{
      width:min(980px, 100%);
      background:var(--card);
      border-radius:20px;
      box-shadow:0 0 10px rgba(0,0,0,.12);
      overflow:hidden;
      display:flex;
      flex-direction:column;
    }
    .header{
      display:flex;
      align-items:center;
      gap:12px;
      background:var(--pink);
      color:#fff;
      padding:16px 20px;
    }
    .header img{
      width:40px; height:40px; border-radius:50%;
      background:#fff; object-fit:cover;
    }
    .header h1{
      font-size:20px; margin:0;
    }
    .sub{
      font-size:13px; opacity:.95; margin-top:2px;
    }
    .content{
      padding:22px;
      background:#fff5f7;
      border-top:1px solid var(--ring);
    }
    .grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap:16px;
    }
    @media (max-width:900px){ .grid{ grid-template-columns:1fr; } }
    .card{
      background:#fff;
      border:1px solid var(--ring);
      border-radius:var(--radius);
      box-shadow:0 2px 8px rgba(0,0,0,.05);
      padding:18px;
      display:flex; flex-direction:column;
    }
    .badge{
      display:inline-block;
      font-size:12px;
      color:#fff;
      background:var(--pink);
      border-radius:999px;
      padding:4px 10px;
      font-weight:700;
      letter-spacing:.2px;
    }
    .title{ font-size:18px; font-weight:800; margin:10px 0 4px; color:#d81b60; }
    .price{
      font-weight:900; font-size:28px; margin:4px 0 12px;
    }
    .desc{ color:var(--muted); font-size:14px; margin:0 0 10px; }
    ul.features{
      margin:10px 0 16px; padding-left:18px; color:#444; font-size:14px;
    }
    ul.features li{ margin:6px 0; }
    .cta{
      margin-top:auto;
      display:flex; gap:10px; align-items:center;
    }
    .btn{
      width:100%;
      appearance:none;
      border:none;
      background:var(--cta);
      color:#fff;
      border-radius:10px;
      padding:12px 14px;
      font-weight:800;
      cursor:pointer;
      box-shadow: var(--shadow);
      transition:transform .06s ease, filter .12s ease;
      text-align:center;
    }
    .btn:hover{ filter:brightness(.95); }
    .btn:active{ transform:translateY(1px); }
    .btn[disabled]{ opacity:.5; cursor:not-allowed; filter:grayscale(.2); }

    .footer{
      padding:14px 20px;
      border-top:1px solid var(--ring);
      background:#fff;
      color:#555;
      font-size:12px;
      display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;
    }
    .note{ color:#666; }
    .link{
      color:#fff; text-decoration:none; font-weight:700;
      background:#ef476f; padding:6px 10px; border-radius:8px;
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="header">
      <img src="logo.png" alt="Charmr Logo" />
      <div>
        <h1>Upgrade to Charmr Premium</h1>
        <div class="sub">Unlock contact sharing, unlimited pictures, gifts & more.</div>
      </div>
    </div>

    <div class="content">
      <div class="grid">
        <!-- Plan 1: £5/mo -->
        <div class="card">
          <span class="badge">Starter</span>
          <div class="title">Basic Access</div>
          <div class="price">£5<span style="font-size:14px;font-weight:700">/mo</span></div>
          <p class="desc">Great if you’re just getting started.</p>
          <ul class="features">
            <li>Send & receive messages</li>
            <li>Receive <strong>2 pictures</strong> per chat</li>
            <li>Gift suggestions</li>
          </ul>
          <div class="cta">
            <button class="btn" data-mode="subscription"
              data-price="price_1Rsdy1EJXIhiKzYGOtzvwhUH">Get Starter</button>
          </div>
        </div>

        <!-- Plan 2: £20/mo -->
        <div class="card" style="border-width:2px">
          <span class="badge">Most Popular</span>
          <div class="title">Premium</div>
          <div class="price">£20<span style="font-size:14px;font-weight:700">/mo</span></div>
          <p class="desc">Unlock all premium features.</p>
          <ul class="features">
            <li>Unlimited pictures</li>
            <li>Contact & links sharing</li>
            <li>Send gifts & priority replies</li>
          </ul>
          <div class="cta">
            <button class="btn" data-mode="subscription"
              data-price="price_1RsdzREJXIhiKzYG45b69nSl">Get Premium</button>
          </div>
        </div>

        <!-- Plan 3: VIP (placeholder until you provide a price_id) -->
        <div class="card">
          <span class="badge">VIP</span>
          <div class="title">VIP Access</div>
          <div class="price">£—<span style="font-size:14px;font-weight:700">/mo</span></div>
          <p class="desc">White-glove experience, exclusive perks.</p>
          <ul class="features">
            <li>Fast-lane support</li>
            <li>Exclusive drops</li>
            <li>Early access to new features</li>
          </ul>
          <div class="cta">
            <!-- Add data-price="price_xxx" when you have it -->
            <button class="btn" disabled title="Add Stripe price_id to enable">Coming Soon</button>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="note">Payments secured by Stripe. You can cancel anytime.</div>
      <a class="link" href="/chat.html">Back to chat</a>
    </div>
  </div>

  <script>
    // 1) Replace with your real Stripe publishable key
    const STRIPE_PUBLISHABLE_KEY = "pk_live_xxx"; // <-- TODO

    // 2) Success & cancel URLs (adjust to your site)
    const successUrl = window.location.origin + "/success.html";
    const cancelUrl  = window.location.origin + "/checkout.html";

    // Guard
    if (!STRIPE_PUBLISHABLE_KEY || STRIPE_PUBLISHABLE_KEY.includes("pk_live_xxx")) {
      console.warn("Set STRIPE_PUBLISHABLE_KEY to your real publishable key.");
    }

    const stripe = Stripe(STRIPE_PUBLISHABLE_KEY);

    function setLoading(btn, on){
      if (!btn) return;
      btn.dataset.originalText ??= btn.textContent;
      btn.disabled = !!on;
      btn.textContent = on ? "Redirecting…" : btn.dataset.originalText;
    }

    async function goToCheckout(price, mode, btn){
      try{
        setLoading(btn, true);
        const { error } = await stripe.redirectToCheckout({
          mode: mode || "subscription",
          lineItems: [{ price, quantity: 1 }],
          successUrl,
          cancelUrl
        });
        if (error) {
          alert(error.message || "Unable to start checkout.");
        }
      } catch (e){
        console.error(e);
        alert("Something went wrong starting checkout.");
      } finally {
        setLoading(btn, false);
      }
    }

    // Bind all buy buttons
    document.querySelectorAll(".btn[data-price]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const price = btn.getAttribute("data-price");
        const mode  = btn.getAttribute("data-mode") || "subscription";
        if (!price){ return; }
        goToCheckout(price, mode, btn);
      });
    });
  </script>
</body>
</html>
